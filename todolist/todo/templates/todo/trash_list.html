<html>
  <head>
    <title>휴지통 - TODO 목록 앱</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <style>
      .todo-info {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
      }
      .deleted-at {
        font-size: 0.9em;
        color: #666;
      }
      .important-stars {
        color: #ffd700;
      }
      .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .todo-details {
        display: none;
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 4px;
      }
      .todo-details.show {
        display: block;
      }
      .detail-label {
        font-weight: bold;
        color: #666;
      }
    </style>
  </head>
  <body>
  <div class="container">
    <div class="header-container">
      <h1>
        <i class="bi bi-trash"></i> 휴지통
      </h1>
      <a href="{% url 'todo_list' %}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> 목록으로 돌아가기
      </a>
    </div>
    
    {% if deleted_todos %}
    <ul class="list-group">
      {% for todo in deleted_todos %}
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-center">
          <div class="todo-info" onclick="toggleDetails('todo-{{ todo.pk }}')">
            <span>{{ todo.title }}</span>
            {% if todo.important %}
              <span class="important-stars">
                {% for i in ''|ljust:todo.important %}★{% endfor %}
              </span>
            {% endif %}
            <span class="deleted-at">
              <i class="bi bi-clock-history"></i> 
              {{ todo.deleted_at|date:"Y-m-d H:i" }} 삭제됨
            </span>
            <i class="bi bi-chevron-down"></i>
          </div>
          <a href="{% url 'todo_restore' pk=todo.pk %}" class="btn btn-outline-success">
            <i class="bi bi-arrow-counterclockwise"></i> 복원
          </a>
        </div>
        <div id="todo-{{ todo.pk }}" class="todo-details">
          <div class="row">
            <div class="col-md-6">
              <p><span class="detail-label">설명:</span><br>
              {{ todo.description|default:"설명 없음"|linebreaks }}</p>
            </div>
            <div class="col-md-6">
              <p><span class="detail-label">생성일:</span><br>
              {{ todo.created|date:"Y-m-d H:i" }}</p>
              
              {% if todo.deadline %}
              <p><span class="detail-label">마감기한:</span><br>
              {{ todo.deadline|date:"Y-m-d H:i" }}</p>
              {% endif %}
              
              <p><span class="detail-label">중요도:</span><br>
              <span class="important-stars">
                {% for i in ''|ljust:todo.important %}★{% endfor %}
              </span>
              </p>
            </div>
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <div class="alert alert-info">
      휴지통이 비어있습니다.
    </div>
    {% endif %}
  </div>

  <script>
    function toggleDetails(todoId) {
      const details = document.getElementById(todoId);
      details.classList.toggle('show');
      
      // 화살표 아이콘 회전
      const arrow = details.previousElementSibling.querySelector('.bi-chevron-down');
      arrow.style.transform = details.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
      arrow.style.transition = 'transform 0.3s';
    }
  </script>
  </body>
</html>